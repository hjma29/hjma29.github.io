
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>Home - Grafana + Prometheus on HPE GreenLake with NVIDIA GPU</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#monitoring-hpe-greenlake-servers-running-gpu-using-grafana-and-prometheus" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Grafana + Prometheus on HPE GreenLake with NVIDIA GPU" class="md-header__button md-logo" aria-label="Grafana + Prometheus on HPE GreenLake with NVIDIA GPU" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Grafana + Prometheus on HPE GreenLake with NVIDIA GPU
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Home
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Grafana + Prometheus on HPE GreenLake with NVIDIA GPU" class="md-nav__button md-logo" aria-label="Grafana + Prometheus on HPE GreenLake with NVIDIA GPU" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Grafana + Prometheus on HPE GreenLake with NVIDIA GPU
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kubernetes-and-helm-setup" class="md-nav__link">
    <span class="md-ellipsis">
      Kubernetes and Helm Setup
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Kubernetes and Helm Setup">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kubernetes-cluster-setup" class="md-nav__link">
    <span class="md-ellipsis">
      Kubernetes cluster setup
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kubernetes-namespace-setup" class="md-nav__link">
    <span class="md-ellipsis">
      Kubernetes namespace setup
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#helm-chart-installation" class="md-nav__link">
    <span class="md-ellipsis">
      Helm chart installation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gpu-operator-chart-customization" class="md-nav__link">
    <span class="md-ellipsis">
      GPU Operator chart customization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gpu-utilization-simulation" class="md-nav__link">
    <span class="md-ellipsis">
      GPU utilization simulation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#grafana-cloud-integration" class="md-nav__link">
    <span class="md-ellipsis">
      Grafana Cloud Integration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Grafana Cloud Integration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prometheus-remote-write" class="md-nav__link">
    <span class="md-ellipsis">
      Prometheus Remote Write
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prometheus-remote-write-diagram" class="md-nav__link">
    <span class="md-ellipsis">
      Prometheus Remote Write Diagram
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-grafana-cloud-credentials" class="md-nav__link">
    <span class="md-ellipsis">
      Configure Grafana Cloud credentials
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#updating-helm-release-with-configured-value" class="md-nav__link">
    <span class="md-ellipsis">
      Updating Helm release with configured value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#proliant-server-nvidia-gpu-utilization-dashboard" class="md-nav__link">
    <span class="md-ellipsis">
      Proliant Server Nvidia GPU utilization dashboard
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kubernetes-and-helm-setup" class="md-nav__link">
    <span class="md-ellipsis">
      Kubernetes and Helm Setup
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Kubernetes and Helm Setup">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kubernetes-cluster-setup" class="md-nav__link">
    <span class="md-ellipsis">
      Kubernetes cluster setup
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kubernetes-namespace-setup" class="md-nav__link">
    <span class="md-ellipsis">
      Kubernetes namespace setup
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#helm-chart-installation" class="md-nav__link">
    <span class="md-ellipsis">
      Helm chart installation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gpu-operator-chart-customization" class="md-nav__link">
    <span class="md-ellipsis">
      GPU Operator chart customization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gpu-utilization-simulation" class="md-nav__link">
    <span class="md-ellipsis">
      GPU utilization simulation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#grafana-cloud-integration" class="md-nav__link">
    <span class="md-ellipsis">
      Grafana Cloud Integration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Grafana Cloud Integration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#prometheus-remote-write" class="md-nav__link">
    <span class="md-ellipsis">
      Prometheus Remote Write
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prometheus-remote-write-diagram" class="md-nav__link">
    <span class="md-ellipsis">
      Prometheus Remote Write Diagram
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configure-grafana-cloud-credentials" class="md-nav__link">
    <span class="md-ellipsis">
      Configure Grafana Cloud credentials
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#updating-helm-release-with-configured-value" class="md-nav__link">
    <span class="md-ellipsis">
      Updating Helm release with configured value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#proliant-server-nvidia-gpu-utilization-dashboard" class="md-nav__link">
    <span class="md-ellipsis">
      Proliant Server Nvidia GPU utilization dashboard
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="monitoring-hpe-greenlake-servers-running-gpu-using-grafana-and-prometheus">Monitoring HPE GreenLake Servers running GPU using Grafana and Prometheus</h1>
<h2 id="overview">Overview</h2>
<p>HPE GreenLake provides a cloud-native platform for managing and monitoring infrastructure with built-in tools and dashboards. While GreenLake offers comprehensive native monitoring capabilities, organizations can also leverage the GreenLake API to integrate with popular open-source tools like Grafana and Prometheus. This approach enables teams to consolidate monitoring data across hybrid environments, utilize existing observability workflows, and create customized dashboards tailored to specific operational needs.</p>
<h2 id="kubernetes-and-helm-setup">Kubernetes and Helm Setup</h2>
<h3 id="kubernetes-cluster-setup">Kubernetes cluster setup</h3>
<p>This demonstration environment utilizes a high-availability Kubernetes cluster consisting of three control plane nodes and two worker nodes, </p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nv">wsl</span><span class="o">=</span>&gt;<span class="w"> </span>k<span class="w"> </span>get<span class="w"> </span>node<span class="w"> </span>-o<span class="w"> </span>wide
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>NAME<span class="w">                                </span>STATUS<span class="w">   </span>ROLES<span class="w">           </span>AGE<span class="w">   </span>VERSION<span class="w">   </span>INTERNAL-IP<span class="w">    </span>EXTERNAL-IP<span class="w">   </span>OS-IMAGE<span class="w">             </span>KERNEL-VERSION<span class="w">       </span>CONTAINER-RUNTIME
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>c2-cp-01.hst.enablement.local<span class="w">       </span>Ready<span class="w">    </span>control-plane<span class="w">   </span>80d<span class="w">   </span>v1.32.5<span class="w">   </span><span class="m">10</span>.16.160.51<span class="w">   </span>&lt;none&gt;<span class="w">        </span>Ubuntu<span class="w"> </span><span class="m">22</span>.04.5<span class="w"> </span>LTS<span class="w">   </span><span class="m">5</span>.15.0-144-generic<span class="w">   </span>containerd://2.0.5
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>c2-cp-02.hst.enablement.local<span class="w">       </span>Ready<span class="w">    </span>control-plane<span class="w">   </span>80d<span class="w">   </span>v1.32.5<span class="w">   </span><span class="m">10</span>.16.160.52<span class="w">   </span>&lt;none&gt;<span class="w">        </span>Ubuntu<span class="w"> </span><span class="m">22</span>.04.5<span class="w"> </span>LTS<span class="w">   </span><span class="m">5</span>.15.0-144-generic<span class="w">   </span>containerd://2.0.5
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>c2-cp-03.hst.enablement.local<span class="w">       </span>Ready<span class="w">    </span>control-plane<span class="w">   </span>80d<span class="w">   </span>v1.32.5<span class="w">   </span><span class="m">10</span>.16.160.53<span class="w">   </span>&lt;none&gt;<span class="w">        </span>Ubuntu<span class="w"> </span><span class="m">22</span>.04.5<span class="w"> </span>LTS<span class="w">   </span><span class="m">5</span>.15.0-144-generic<span class="w">   </span>containerd://2.0.5
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>c2-worker-01.hst.enablement.local<span class="w">   </span>Ready<span class="w">    </span>&lt;none&gt;<span class="w">          </span>80d<span class="w">   </span>v1.32.5<span class="w">   </span><span class="m">10</span>.16.160.54<span class="w">   </span>&lt;none&gt;<span class="w">        </span>Ubuntu<span class="w"> </span><span class="m">22</span>.04.5<span class="w"> </span>LTS<span class="w">   </span><span class="m">5</span>.15.0-144-generic<span class="w">   </span>containerd://2.0.5
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>c2-worker-02.hst.enablement.local<span class="w">   </span>Ready<span class="w">    </span>&lt;none&gt;<span class="w">          </span>80d<span class="w">   </span>v1.32.5<span class="w">   </span><span class="m">10</span>.16.160.55<span class="w">   </span>&lt;none&gt;<span class="w">        </span>Ubuntu<span class="w"> </span><span class="m">22</span>.04.5<span class="w"> </span>LTS<span class="w">   </span><span class="m">5</span>.15.0-144-generic<span class="w">   </span>containerd://2.0.5
</span></code></pre></div>
<h3 id="kubernetes-namespace-setup">Kubernetes namespace setup</h3>
<p>The cluster is equipped with the <code>gpu-operator</code> namespace for NVIDIA GPU management and the <code>monitoring</code> namespace hosting the Prometheus stack, with external access enabled via NodePort services.
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="nv">wsl</span><span class="o">=</span>&gt;<span class="w"> </span>kubectl<span class="w"> </span>get<span class="w"> </span>ns<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-vE<span class="w"> </span><span class="s1">&#39;^(kube-|default)&#39;</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>NAME<span class="w">              </span>STATUS<span class="w">   </span>AGE
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>gpu-operator<span class="w">      </span>Active<span class="w">   </span>80d
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>monitoring<span class="w">        </span>Active<span class="w">   </span>56d
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="nv">wsl</span><span class="o">=</span>&gt;<span class="w"> </span>k<span class="w"> </span>get<span class="w"> </span>svc<span class="w"> </span>-n<span class="w"> </span>gpu-operator<span class="w"> </span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>NAME<span class="w">                   </span>TYPE<span class="w">        </span>CLUSTER-IP<span class="w">     </span>EXTERNAL-IP<span class="w">   </span>PORT<span class="o">(</span>S<span class="o">)</span><span class="w">    </span>AGE
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>gpu-operator<span class="w">           </span>ClusterIP<span class="w">   </span><span class="m">10</span>.233.44.80<span class="w">   </span>&lt;none&gt;<span class="w">        </span><span class="m">8080</span>/TCP<span class="w">   </span>78d
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>nvidia-dcgm-exporter<span class="w">   </span>ClusterIP<span class="w">   </span><span class="m">10</span>.233.15.59<span class="w">   </span>&lt;none&gt;<span class="w">        </span><span class="m">9400</span>/TCP<span class="w">   </span>78d
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="nv">wsl</span><span class="o">=</span>&gt;<span class="w"> </span>k<span class="w"> </span>get<span class="w"> </span>svc<span class="w"> </span>--field-selector<span class="w"> </span>spec.type<span class="o">=</span>NodePort<span class="w"> </span>-n<span class="w"> </span>monitoring
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>NAME<span class="w">                               </span>TYPE<span class="w">       </span>CLUSTER-IP<span class="w">      </span>EXTERNAL-IP<span class="w">   </span>PORT<span class="o">(</span>S<span class="o">)</span><span class="w">                         </span>AGE
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>kube-prometheus-stack-grafana<span class="w">      </span>NodePort<span class="w">   </span><span class="m">10</span>.233.22.241<span class="w">   </span>&lt;none&gt;<span class="w">        </span><span class="m">80</span>:30080/TCP<span class="w">                    </span>56d
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>kube-prometheus-stack-prometheus<span class="w">   </span>NodePort<span class="w">   </span><span class="m">10</span>.233.8.106<span class="w">    </span>&lt;none&gt;<span class="w">        </span><span class="m">9090</span>:30090/TCP,8080:30398/TCP<span class="w">   </span>56d
</span></code></pre></div></p>
<h3 id="helm-chart-installation">Helm chart installation</h3>
<p>The environment uses Helm to manage two key components: the NVIDIA GPU Operator for GPU resource management and the Kube Prometheus Stack for monitoring and observability.</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="nv">wsl</span><span class="o">=</span>&gt;<span class="w"> </span>helm<span class="w"> </span>list<span class="w"> </span>-A
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>NAME<span class="w">                    </span>NAMESPACE<span class="w">       </span>REVISION<span class="w">        </span>UPDATED<span class="w">                                 </span>STATUS<span class="w">          </span>CHART<span class="w">                           </span>APP<span class="w"> </span>VERSION
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>gpu-operator-1753140595<span class="w"> </span>gpu-operator<span class="w">    </span><span class="m">4</span><span class="w">               </span><span class="m">2025</span>-08-14<span class="w"> </span><span class="m">19</span>:20:42.329819669<span class="w"> </span>-0700<span class="w"> </span>MST<span class="w"> </span>deployed<span class="w">        </span>gpu-operator-v25.3.2<span class="w">            </span>v25.3.2<span class="w">    </span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>kube-prometheus-stack<span class="w">   </span>monitoring<span class="w">      </span><span class="m">5</span><span class="w">               </span><span class="m">2025</span>-08-15<span class="w"> </span><span class="m">13</span>:06:31.169338089<span class="w"> </span>-0700<span class="w"> </span>MST<span class="w"> </span>deployed<span class="w">        </span>kube-prometheus-stack-76.3.
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="m">0</span><span class="w">    </span>v0.84.1<span class="w">    </span>
</span></code></pre></div>
<h3 id="gpu-operator-chart-customization">GPU Operator chart customization</h3>
<p>The NVIDIA GPU Operator Helm chart deploys a DCGM (Data Center GPU Manager) exporter by default, but there are important nuances:</p>
<ul>
<li>
<p>The DCGM exporter Pod will be created automatically when the operator detects a node with an NVIDIA GPU and the dcgm-exporter component is enabled in its values.
<div class="language-bash highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="nv">wsl</span><span class="o">=</span>&gt;<span class="w"> </span>k<span class="w"> </span>-n<span class="w"> </span>gpu-operator<span class="w"> </span>get<span class="w"> </span>pods<span class="w"> </span>-o<span class="w"> </span>wide<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>dcgm
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>nvidia-dcgm-exporter-gkg6d<span class="w">                                        </span><span class="m">1</span>/1<span class="w">     </span>Running<span class="w">     </span><span class="m">0</span><span class="w">          </span>56d<span class="w">   </span><span class="m">10</span>.233.117.209<span class="w">   </span>c2-worker-01.hst.enablement.local<span class="w">   </span>&lt;none&gt;<span class="w">           </span>&lt;none&gt;
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>nvidia-dcgm-exporter-r2np6<span class="w">                                        </span><span class="m">1</span>/1<span class="w">     </span>Running<span class="w">     </span><span class="m">0</span><span class="w">          </span>56d<span class="w">   </span><span class="m">10</span>.233.114.15<span class="w">    </span>c2-worker-02.hst.enablement.local<span class="w">   </span>&lt;none&gt;<span class="w">           </span>&lt;none&gt;
</span></code></pre></div></p>
</li>
<li>
<p>In the stock gpu-operator Helm chart from NVIDIA's repository, the DCGM exporter is enabled by default (<code>dcgmExporter.enabled: true</code>), but the ServiceMonitor is disabled by default (<code>serviceMonitor.enabled: false</code>). See the <a href="https://docs.nvidia.com/datacenter/cloud-native/gpu-operator/latest/getting-started.html#operator-install-guide">NVIDIA GPU Operator Documentation</a>. <br></p>
</li>
</ul>
<p><img alt="GPU Operator Configuration" src="../images/image-4.png" /></p>
<p>You can also verify these default built-in values using the <code>helm show values</code> command. 
<div class="language-bash highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="nv">wsl</span><span class="o">=</span>&gt;<span class="w"> </span>helm<span class="w"> </span>show<span class="w"> </span>values<span class="w"> </span>nvidia/gpu-operator<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-A<span class="w"> </span><span class="m">15</span><span class="w"> </span>dcgmExporter
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>dcgmExporter:
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="w">  </span>enabled:<span class="w"> </span><span class="nb">true</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="w">  </span>repository:<span class="w"> </span>nvcr.io/nvidia/k8s
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="w">  </span>image:<span class="w"> </span>dcgm-exporter
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="w">  </span>version:<span class="w"> </span><span class="m">4</span>.3.1-4.4.0-ubuntu22.04
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="w">  </span>imagePullPolicy:<span class="w"> </span>IfNotPresent
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="w">  </span>env:<span class="w"> </span><span class="o">[]</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="w">  </span>resources:<span class="w"> </span><span class="o">{}</span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="w">  </span>service:
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a><span class="w">    </span>internalTrafficPolicy:<span class="w"> </span>Cluster
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a><span class="w">  </span>serviceMonitor:
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a><span class="w">    </span>enabled:<span class="w"> </span><span class="nb">false</span>
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a><span class="w">    </span>interval:<span class="w"> </span>15s
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a><span class="w">    </span>honorLabels:<span class="w"> </span><span class="nb">false</span>
</span><span id="__span-4-16"><a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a><span class="w">    </span>additionalLabels:<span class="w"> </span><span class="o">{}</span>
</span><span id="__span-4-17"><a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a><span class="w">    </span>relabelings:<span class="w"> </span><span class="o">[]</span>
</span></code></pre></div></p>
<p>We need to enable  the ServiceMonitor (<code>dcgmExporter.serviceMonitor.enabled: true</code>) in order for Prometheus to automatically scrape the DCGM exporter.</p>
<p>The gpu-operator is configured with custom values to enable Prometheus integration. The DCGM exporter runs as a ClusterIP service with ServiceMonitor enabled for automatic metrics discovery by Prometheus.
<div class="language-bash highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="nv">wsl</span><span class="o">=</span>&gt;<span class="w"> </span>helm<span class="w"> </span>get<span class="w"> </span>values<span class="w"> </span>gpu-operator-1753140595<span class="w"> </span>-n<span class="w"> </span>gpu-operator
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>USER-SUPPLIED<span class="w"> </span>VALUES:
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>dcgmExporter:
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="w">  </span>service:
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="w">    </span>type:<span class="w"> </span>ClusterIP
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="w">  </span>serviceMonitor:
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="w">    </span>enabled:<span class="w"> </span><span class="nb">true</span>
</span></code></pre></div></p>
<h3 id="gpu-utilization-simulation">GPU utilization simulation</h3>
<p>To simulate GPU load and verify monitoring functionality, we deployed a test pod running the gpu-burn utility. This tool performs intensive GPU computations, allowing us to observe GPU utilization metrics in our monitoring dashboards.</p>
<p>The following YAML manifest creates a pod that clones the gpu-burn repository, compiles it, and runs continuous GPU stress testing:</p>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Pod</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="nt">metadata</span><span class="p">:</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gpu-burn</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="nt">spec</span><span class="p">:</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="w">    </span><span class="nt">containers</span><span class="p">:</span>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gpu-burn</span>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="w">            </span><span class="l l-Scalar l-Scalar-Plain">image</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nvidia/cuda:12.2.0-devel-ubuntu22.04</span><span class="w"> </span>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="w">            </span><span class="l l-Scalar l-Scalar-Plain">command</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;/bin/bash&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;-c&quot;</span><span class="p p-Indicator">]</span>
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a><span class="w">            </span><span class="nt">args</span><span class="p">:</span>
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a><span class="w">                </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">|</span>
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a><span class="w">                    </span><span class="no">apt update &amp;&amp; apt install -y git build-essential &amp;&amp; \</span>
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a><span class="w">                    </span><span class="no">git clone https://github.com/wilicc/gpu-burn.git &amp;&amp; \</span>
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a><span class="w">                    </span><span class="no">cd gpu-burn &amp;&amp; make &amp;&amp; ./gpu_burn 999999 </span>
</span><span id="__span-6-15"><a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a><span class="w">            </span><span class="nt">resources</span><span class="p">:</span>
</span><span id="__span-6-16"><a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a><span class="w">                </span><span class="nt">limits</span><span class="p">:</span>
</span><span id="__span-6-17"><a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a><span class="w">                    </span><span class="nt">nvidia.com/gpu</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
</span><span id="__span-6-18"><a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a><span class="w">    </span><span class="nt">restartPolicy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Never</span>
</span></code></pre></div>
<p><strong>Key configuration details:</strong>
- <strong>Base image</strong>: <code>nvidia/cuda:12.2.0-devel-ubuntu22.04</code> provides the CUDA development environment<br />
- <strong>GPU allocation</strong>: <code>nvidia.com/gpu: 1</code> requests a single GPU from the cluster<br />
- <strong>Runtime</strong>: <code>gpu_burn 999999</code> runs for approximately 277 hours (effectively continuous)<br />
- <strong>Restart policy</strong>: <code>Never</code> ensures the pod completes its run without automatic restarts  </p>
<p>Deploy the pod using:
<div class="language-bash highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>gpu-burn.yaml
</span></code></pre></div></p>
<h2 id="grafana-cloud-integration">Grafana Cloud Integration</h2>
<p>While the local Grafana deployment provides comprehensive monitoring capabilities, organizations often need to share dashboards with team members who cannot directly access the internal infrastructure. Grafana Cloud offers an ideal solution by enabling metrics to be pushed from the local Prometheus instance to a cloud-hosted environment, making dashboards accessible to remote teams without requiring VPN or direct network access.</p>
<h3 id="prometheus-remote-write">Prometheus Remote Write</h3>
<p>Grafana Cloud supports Prometheus remote write protocol, allowing local Prometheus to continuously push metrics to the cloud. This approach offers several advantages:</p>
<ul>
<li><strong>No inbound firewall rules required</strong> - Metrics are pushed outbound from the lab</li>
<li><strong>Real-time data synchronization</strong> - Metrics appear in Grafana Cloud within seconds</li>
<li><strong>Selective metric filtering</strong> - Control which metrics are sent to manage costs</li>
<li><strong>Multi-cluster aggregation</strong> - Consolidate metrics from multiple environments</li>
</ul>
<p>The integration involves two main steps:</p>
<ol>
<li><strong>Configure Grafana Cloud credentials</strong> - Create a Prometheus remote write endpoint and API key in Grafana Cloud</li>
<li><strong>Update Prometheus configuration</strong> - Add remote write settings to the kube-prometheus-stack Helm values</li>
</ol>
<h3 id="prometheus-remote-write-diagram">Prometheus Remote Write Diagram</h3>
<p>The following diagram from Grafana Cloud documentation shows the architecture of Prometheous remote write. <br></p>
<p><img alt="Prometheous Remote Write" src="../images/image-5.png" /></p>
<p><strong>How it works:</strong>
1. Prometheus scrapes metrics from all targets (DCGM exporter, kube-state-metrics, etc.)
2. Stores metrics locally in TSDB (Time Series Database)
3. Simultaneously pushes metrics to Grafana Cloud via remote write
4. Local Grafana and Prometheus UI can query local data
5. Grafana Cloud receives a copy of all metrics</p>
<h3 id="configure-grafana-cloud-credentials">Configure Grafana Cloud credentials</h3>
<p>Users should login to <code>grafana.com</code> to access their grafana stack and retrive the prometheous cloud instance API endpoint by selecting "Details". <br></p>
<p><img alt="Grafana Cloud Portal" src="../images/CleanShot%202025-10-20%20at%2009.38.20.png" /></p>
<p>Select "Prometheous Details" <br></p>
<p><img alt="Stack Dashboard" src="../images/CleanShot%202025-10-20%20at%2009.41.58.png" /></p>
<p>In <code>Prometheous Instance Details</code> page, please note "Remote Write Endpoint", "Instance ID" and generate "API Token" <br></p>
<p><img alt="Prometheous Instance Details" src="../images/CleanShot%202025-10-20%20at%2009.48.41.png" /></p>
<h3 id="updating-helm-release-with-configured-value">Updating Helm release with configured value</h3>
<ol>
<li>
<p>Create Kubernetes secret to store the username and password to access prometheous cloud instance
<div class="language-bash highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="nv">wsl</span><span class="o">=</span>&gt;<span class="w"> </span><span class="nv">GRAFANA_CLOUD_USER</span><span class="o">=</span><span class="s2">&quot;&lt;your userid here&gt;&quot;</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="nv">wsl</span><span class="o">=</span>&gt;<span class="w"> </span><span class="nv">GRAFANA_CLOUD_PASSWORD</span><span class="o">=</span><span class="s2">&quot;&lt;you token here&gt;&quot;</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="nv">wsl</span><span class="o">=</span>&gt;<span class="w"> </span>kubectl<span class="w"> </span>create<span class="w"> </span>secret<span class="w"> </span>generic<span class="w"> </span>grafana-cloud-credentials<span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="w">  </span>--from-literal<span class="o">=</span><span class="nv">username</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">GRAFANA_CLOUD_USER</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="w">  </span>--from-literal<span class="o">=</span><span class="nv">password</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">GRAFANA_CLOUD_PASSWORD</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="w">  </span>-n<span class="w"> </span>monitoring
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a>secret/grafana-cloud-credentials<span class="w"> </span>created
</span></code></pre></div></p>
</li>
<li>
<p>Create helm custom values yaml file
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="l l-Scalar l-Scalar-Plain">wsl=&gt; cat prometheus-remote-write-values.yaml</span><span class="w"> </span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="l l-Scalar l-Scalar-Plain">prometheus</span><span class="p p-Indicator">:</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="w">  </span><span class="nt">prometheusSpec</span><span class="p">:</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="w">    </span><span class="nt">remoteWrite</span><span class="p">:</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://&lt;your-prometheus-id-here&gt;.grafana.net/api/prom/push</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="w">        </span><span class="nt">basicAuth</span><span class="p">:</span>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="w">          </span><span class="nt">username</span><span class="p">:</span>
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a><span class="w">            </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">grafana-cloud-credentials</span>
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a><span class="w">            </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">username</span>
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a><span class="w">          </span><span class="nt">password</span><span class="p">:</span>
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a><span class="w">            </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">grafana-cloud-credentials</span>
</span><span id="__span-9-12"><a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a><span class="w">            </span><span class="nt">key</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">password</span>
</span></code></pre></div></p>
</li>
<li>
<p>Upgrade helm releases
<div class="language-bash highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="nv">wsl</span><span class="o">=</span>&gt;<span class="w"> </span>helm<span class="w"> </span>upgrade<span class="w"> </span>kube-prometheus-stack<span class="w"> </span>prometheus-community/kube-prometheus-stack<span class="w">   </span>-n<span class="w"> </span>monitoring<span class="w">   </span>-f<span class="w"> </span>prometheus-remote-write-values.yaml<span class="w">   </span>--reuse-values
</span></code></pre></div></p>
</li>
</ol>
<h3 id="proliant-server-nvidia-gpu-utilization-dashboard">Proliant Server Nvidia GPU utilization dashboard</h3>
<p>The following screen shows the Grafana Cloud dashboard of HPE Proliant Server Nvidia GPU Utilization. <br></p>
<p><img alt="GPU Utilization Panel" src="../images/CleanShot%202025-10-20%20at%2010.35.20.png" /></p>
<p>The corresponding server GPU utilization from <code>nvidia-smi</code> is shown below.
<div class="language-bash highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="nv">wsl</span><span class="o">=</span>&gt;<span class="w"> </span>ssh<span class="w"> </span>user01@c2-worker-02.hst.enablement.local<span class="w"> </span>nvidia-smi
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>Mon<span class="w"> </span>Oct<span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">13</span>:55:11<span class="w"> </span><span class="m">2025</span><span class="w">       </span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>+-----------------------------------------------------------------------------------------+
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="p">|</span><span class="w"> </span>NVIDIA-SMI<span class="w"> </span><span class="m">570</span>.133.20<span class="w">             </span>Driver<span class="w"> </span>Version:<span class="w"> </span><span class="m">570</span>.133.20<span class="w">     </span>CUDA<span class="w"> </span>Version:<span class="w"> </span><span class="m">12</span>.8<span class="w">     </span><span class="p">|</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="p">|</span>-----------------------------------------+------------------------+----------------------+
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="p">|</span><span class="w"> </span>GPU<span class="w">  </span>Name<span class="w">                 </span>Persistence-M<span class="w"> </span><span class="p">|</span><span class="w"> </span>Bus-Id<span class="w">          </span>Disp.A<span class="w"> </span><span class="p">|</span><span class="w"> </span>Volatile<span class="w"> </span>Uncorr.<span class="w"> </span>ECC<span class="w"> </span><span class="p">|</span>
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="p">|</span><span class="w"> </span>Fan<span class="w">  </span>Temp<span class="w">   </span>Perf<span class="w">          </span>Pwr:Usage/Cap<span class="w"> </span><span class="p">|</span><span class="w">           </span>Memory-Usage<span class="w"> </span><span class="p">|</span><span class="w"> </span>GPU-Util<span class="w">  </span>Compute<span class="w"> </span>M.<span class="w"> </span><span class="p">|</span>
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="p">|</span><span class="w">                                         </span><span class="p">|</span><span class="w">                        </span><span class="p">|</span><span class="w">               </span>MIG<span class="w"> </span>M.<span class="w"> </span><span class="p">|</span>
</span><span id="__span-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a><span class="p">|</span><span class="o">=========================================</span>+<span class="o">========================</span>+<span class="o">======================</span><span class="p">|</span>
</span><span id="__span-11-10"><a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a><span class="p">|</span><span class="w">   </span><span class="m">0</span><span class="w">  </span>NVIDIA<span class="w"> </span>L40S-4C<span class="w">                 </span>On<span class="w">  </span><span class="p">|</span><span class="w">   </span><span class="m">00000000</span>:02:00.0<span class="w"> </span>Off<span class="w"> </span><span class="p">|</span><span class="w">                    </span><span class="m">0</span><span class="w"> </span><span class="p">|</span>
</span><span id="__span-11-11"><a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a><span class="p">|</span><span class="w"> </span>N/A<span class="w">   </span>N/A<span class="w">    </span>P0<span class="w">            </span>N/A<span class="w">  </span>/<span class="w">  </span>N/A<span class="w">  </span><span class="p">|</span><span class="w">    </span>3002MiB<span class="w"> </span>/<span class="w">   </span>4096MiB<span class="w"> </span><span class="p">|</span><span class="w">     </span><span class="m">99</span>%<span class="w">      </span>Default<span class="w"> </span><span class="p">|</span>
</span><span id="__span-11-12"><a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a><span class="p">|</span><span class="w">                                         </span><span class="p">|</span><span class="w">                        </span><span class="p">|</span><span class="w">                  </span>N/A<span class="w"> </span><span class="p">|</span>
</span><span id="__span-11-13"><a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a>+-----------------------------------------+------------------------+----------------------+
</span><span id="__span-11-14"><a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a>
</span><span id="__span-11-15"><a id="__codelineno-11-15" name="__codelineno-11-15" href="#__codelineno-11-15"></a>+-----------------------------------------------------------------------------------------+
</span><span id="__span-11-16"><a id="__codelineno-11-16" name="__codelineno-11-16" href="#__codelineno-11-16"></a><span class="p">|</span><span class="w"> </span>Processes:<span class="w">                                                                              </span><span class="p">|</span>
</span><span id="__span-11-17"><a id="__codelineno-11-17" name="__codelineno-11-17" href="#__codelineno-11-17"></a><span class="p">|</span><span class="w">  </span>GPU<span class="w">   </span>GI<span class="w">   </span>CI<span class="w">              </span>PID<span class="w">   </span>Type<span class="w">   </span>Process<span class="w"> </span>name<span class="w">                        </span>GPU<span class="w"> </span>Memory<span class="w"> </span><span class="p">|</span>
</span><span id="__span-11-18"><a id="__codelineno-11-18" name="__codelineno-11-18" href="#__codelineno-11-18"></a><span class="p">|</span><span class="w">        </span>ID<span class="w">   </span>ID<span class="w">                                                               </span>Usage<span class="w">      </span><span class="p">|</span>
</span><span id="__span-11-19"><a id="__codelineno-11-19" name="__codelineno-11-19" href="#__codelineno-11-19"></a><span class="p">|</span><span class="o">=========================================================================================</span><span class="p">|</span>
</span><span id="__span-11-20"><a id="__codelineno-11-20" name="__codelineno-11-20" href="#__codelineno-11-20"></a><span class="p">|</span><span class="w">    </span><span class="m">0</span><span class="w">   </span>N/A<span class="w">  </span>N/A<span class="w">         </span><span class="m">3712514</span><span class="w">      </span>C<span class="w">   </span>./gpu_burn<span class="w">                             </span>2997MiB<span class="w"> </span><span class="p">|</span>
</span><span id="__span-11-21"><a id="__codelineno-11-21" name="__codelineno-11-21" href="#__codelineno-11-21"></a>+-----------------------------------------------------------------------------------------+
</span></code></pre></div></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>